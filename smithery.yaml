# Smithery configuration file: https://smithery.ai/docs/build/project-config/smithery.yaml

version: 2
description: "Discord MCP server with 70+ tools for community management, moderation, and automation"
runtime: "container"
startCommand:
  type: "http"
  command: ["node", "build/fast-start.js"]
  configSchema:
    type: object
    required:
      - discordToken
    properties:
      discordToken:
        type: string
        title: "Discord Bot Token"
        description: "Discord bot token. Obtain this from the Discord Developer Portal."
       enableUserManagement:
         type: boolean
         title: "Enable User Management"
         description: "Enable user moderation tools (kick, ban, timeout, roles). Requires appropriate bot permissions."
         default: true
       enableVoiceChannels:
         type: boolean
         title: "Enable Voice Channels"
         description: "Enable voice channel management tools. Requires Connect, Speak, and Move Members permissions."
         default: true
       enableDirectMessages:
         type: boolean
         title: "Enable Direct Messages"
         description: "Enable sending direct messages to users. Users may have DMs disabled."
         default: true
       enableServerManagement:
         type: boolean
         title: "Enable Server Management"
         description: "Enable server settings, emojis, and administrative tools. Requires Manage Guild permissions."
         default: true
       enableRbac:
         type: boolean
         title: "Enable RBAC (Role-Based Access Control)"
         description: "Enable role creation, editing, and permission management. Requires Manage Roles permissions."
         default: true
       enableContentManagement:
         type: boolean
         title: "Enable Content Management"
         description: "Enable bulk operations and advanced content moderation tools."
         default: true
      allowGuildIds:
        type: string
        title: "Allowed Guild IDs (Optional)"
        description: "Comma-separated list of Discord server IDs to restrict bot access to. Leave empty to allow all servers."
        default: ""
      allowChannelIds:
        type: string
        title: "Allowed Channel IDs (Optional)"
        description: "Comma-separated list of Discord channel IDs to restrict bot access to. Leave empty to allow all channels."
        default: ""
  exampleConfig:
    discordToken: YOUR_DISCORD_BOT_TOKEN
    enableUserManagement: true
    enableVoiceChannels: true
    enableDirectMessages: true
    enableServerManagement: true
    enableRbac: true
    enableContentManagement: true
    allowGuildIds: ""
    allowChannelIds: ""
  env:
    # Primary method - standard template
    DISCORD_TOKEN: "{{discordToken}}"
    # Alternative patterns for Smithery.ai compatibility
    discordToken: "{{discordToken}}"
    DISCORDTOKEN: "{{discordToken}}"
    TOKEN: "{{discordToken}}"
    BOT_TOKEN: "{{discordToken}}"
    # Debug flag
    DEBUG_TOKEN: "true"
    # Feature flags - enable all tools for Smithery discovery
    ENABLE_USER_MANAGEMENT: "true"
    ENABLE_VOICE_CHANNELS: "true"
    ENABLE_DIRECT_MESSAGES: "true"
    ENABLE_SERVER_MANAGEMENT: "true"
    ENABLE_RBAC: "true"
    ENABLE_CONTENT_MANAGEMENT: "true"
    # Security settings
    ALLOW_GUILD_IDS: "{{allowGuildIds}}"
    ALLOW_CHANNEL_IDS: "{{allowChannelIds}}"

build:
  dockerfile: Dockerfile
